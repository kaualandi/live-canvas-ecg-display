<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="styles/main.css">
        <link rel="icon" type="image/x-icon" href="images/favicon.ico">
        <title>Live Canvas ECG display</title>
    </head>
    <body>
        <div id="wrapper">
            <canvas></canvas>
            <script src="scripts/ecg.js"></script>
            <div id="controls">
                <section id="views">
                    <h2>Views</h2>
                    <i>No views available</i>
                </section>
                <section>
                    <h2>Something goes here</h2>
                    <div>Something</div>
                </section>
                <section>
                    <h2>Heart rate</h2>
                    <div><div id="hr">n/a</div></div>
                </section>
                <script>
                    refreshViews = () => {
                        const availableViews = ecg.getAvailableViews();
                        const view = ecg.getView();
                        let html = `<h2>Views</h2>`;
                        for(var i = 0; i < availableViews.length; i++) {
                            html += `
                            <div><label for="view-${availableViews[i]}">${availableViews[i]}</label> <input id="view-${availableViews[i]}" type="radio" name="view" onchange="ecg.setView(this.value)" value="${availableViews[i]}"></div>`;
                        }
                        if(availableViews.length === 0) {
                            html += `
                            <i>No views available</i>`;
                        }
                        document.getElementById("views").innerHTML = html;
                        if(availableViews.includes(view)) {
                            document.getElementById("view-" + view).setAttribute("checked", "");
                        } else if(availableViews[0]) {
                            ecg.setView(availableViews[0]);
                            document.getElementById("view-" + availableViews[0]).setAttribute("checked", "");
                        } else {
                            ecg.setView(null);
                        }
                    }
                    setInterval(refreshViews,1000);
                </script>
            </div>
        </div>
    </body>
</html>